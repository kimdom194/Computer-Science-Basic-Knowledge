### 제어 유니트

- 제어 유니트 기능
  - 명령어 코드(오피코드)의 해독
  - 명령어 실행에 필요한 제어 신호의 발생
-  마이크로 명령어 : 명령어 사이클의 각 주기에서 실행되는 마이크로 연산들에 대응되는 비트들로 이루어진 단어로서, 제어 단어라고도 함
- 마이크로 프로그램 : 마이크로 명령어들의 집합
- 루틴 : CPU의 특정 기능을 수행하기 위한 마이크로 명령어들의 그룹



구성 요소들

 - 명령어 해독기 : 명령어 레지스(IR)로부터 들어오는 명령어의 연산코드를 해독하여 해당 연산을 수행하기 위한 루틴의 시작주소를 결정
 - 제어 주소 레지스터 : 다음에 실행할 마이크로명령어의 주소를 저장하는 레지스터 > 제어 기억장치의 특정 위치를 지칭
 - 제어 기억장치 : 마이크로명령어들로 이루어진 마이크로프로그램을 저장하는 내부 기억장치
 - 제어 버퍼 레지스터 : 마이크로 명령어 비트들을 일시적으로 저장하는 레지스터
 - 서브루틴 레지스터 : 서브루틴이 호출되는 경우 현재의 내용을 일시적으로 저장
 - 순서제어 모듈 : 마이크로명령어 실행순서를 결정하는 회로들의 집합



CPU의 명령어 세트 설계 과정

1. 명령어들의 종류와 비트 패턴 정의

2. 명령어들의 실행에 필요한 하드웨어 설계

3. 각 명령어를 위한 실행 사이클 루틴 작성

4. ##### 마이크로프로그램 코드들을 제어 기억장치에 저장



명령어 해독 : 실행 사이클 루틴의 시작 주소를 결정하는 동작

- 사상을 이용한 해독 방법

  - 명령어의 연산 코드를 특정 비트 패턴과 조합 

  EX ) 1 _ _ _ _ 0 0 

   - 뒤에 0 0 이 고정인 이유 : 한 루틴당 8비트라고 가정
   - 인출과 나머지 사이클의 구분을 맨 앞 1과 0의 차이로 구분
   - 그렇다면 중간 4자리의 자릿수의 매핑을 통하여 주소로 찾아갈 수 있음



마이크로명령어의 형식

- 연산 필드가 두 개이면, 두 개의 마이크로-연산들을 동시에 수행 가능
- 조건(CD) 필드는 분기에 사용될 조건 플래그를 지정
- 분기(BR) 필드는 분기의 종류와 다음에 실행할 마이크로명령어의 주소를 결정하는 방법을 명시
- 주소 필드(ADF)의 내용은 분기가 발생하는 경우에 목적지 마이크로명령어의 주소로 사용



조건 필드 : 두 비트로 구성되며, 분기의 조건으로 사용

- U : 무조건 분기
- I : 만약 I = 1이면 간접 사이클 루틴을 호출
- S : 누산기에 저장된 데이터의 부호가 1이면, 분기
- Z : 누산기에 저장된 데이터가 0이면 분기



분기 필드 : 두 비트로 구성되며, 분기 동작을 지정

- 조건 필드의 조건이 만족되면 ADF필드의 내용을 CAR로 적재 > 그 주소로 JUMP 혹은 CALL
- RET : 서브루틴으로 복귀(SBR에 저장된 내용을 CAR로 적재)
- MAP : 사상 방식에 의하여 분기 목적지 주소 결정

흐름을 기억

제어 신호의 생성

- 제어 기억장치로부터 인출된 마이크로명령어 내 연산 필드의 비튿글이 제어 유니트의 외부로 출력되어, 각각 제어 신호로 사용됨

1. 수직적 마이크로 프로그래밍
   - 마이크로명령어의 연산 필드에 적은 수의 코드화된 비트들을 포함시키고, 해독기를 이용하여 그 비트들을 필요한 수 만큼의 제어 신호들로 확장하는 방식
   - 장점 : 길이(비트 수) 최소화 > 제어 기억장치 용량 감소
   - 단점 : 해독 동작에 걸리는 만큼의 지연 시간 발생
2. 수평적 마이크로 프로그래밍
   - 연산 필드의 각 비트와 제어 신호를 1:1로 대응시키는 방식
   - 필요한 제어 신호 수만큼의 비트들로 이루어진 연산필드 비트들이 마이크로명령어에 포함되어야 함
   - 장점 : 하드웨어가 간단하고 해독에 따른 지연 시간이 없음
   - 단점 : 비트 수가 길어지기 때문에 제어 기억장치의 용량이 증가