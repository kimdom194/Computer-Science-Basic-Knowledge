- ### 소켓 시스템

  - 소켓 주소

    - 프로토콜의 종류에 따라 사용하는 주소 체계가 다름
      - AF_UNIX: 한 호스트에 존재하는 프로세스 사이의 통신을 지원
      - AF_INET: 다른 호스트에 존재하는 프로세스 사이의 통신을 지원
    - 유닉스 주소 체계
      - AF_UNIX
        - 한 호스트에 존재하는 프로세스 사이의 통신을 지원
        - 주소 체계는 파일 시스템의 경로명을 기반으로 함

    - 인터넷 주소 체계
      - AF_INET
        - 다른 호스트에 존재하는 프로세스 사이의 통신을 지원
        - 주소 체계는 32비트 IP 주소와 16 비트 포트 번호를 기반으로 함
    - 통합 주소 체계
      - 프로토콜마다 주소 체계를 지원하는 문법 구조가 다름
      - 문법 구조상 하나의 함수에서 다양한 주소 체계를 지원하는데 어려움이 있음
      - 따라서 모든 주소 체계를 수용할 수 있는 공통 주소 체계가 필요함

  - 소켓 서비스

    - 소켓 유형
    - SOCK_STREAM
      - 연결형 서비스를 지원
      - AF_INET에서는 TCP 프로토콜을 사용
    - SOCK_DGRM
      - 비연결형 서비스를 지원
      - AF_INET에서는 UDP 프로토콜을 사용
    - SOCK_RAW
      - IP 프로토콜을 직접 사용

  - 소켓 함수

    - s = socket (int domain, int type, int protocol)

      - 매개 변수로 지정된 유형을 지원하는 소켓을 생성
      - 생성된 소켓을 가리키는 파일 디스크립터를 리턴

    - bind (int s, struct sockaddr *name, socklen_t *namelen)

      - s가 가리키는 소켓에 소켓 주소를 부여함
      - name: 소켓 주소

    - listen (int s, int backlog)

      - 소켓을 활성화 시킴
      - 소켓에서 대기할 수 있는 연결 요청의 개수를 지정

    - accept (int s, struct sockaddr *addr, socklen_t *addrlen)

      - 클라이언트/서버 환경에서 서버가 대기하는 역할을 함
      - 클라이언트의 connect() 함수와 만나면 소켓 연결을 설정함

    - connect (int s, struct sockaddr *name, socklen_t namelen)

      - 클라이언트/서버 환경에서 클라이언트의 연결 설정 요청을 수행함
      - 서버의 accept() 함수와 만나면 소켓 연결을 설정함

    - send (int s, void *msg, size_t len, int flags)

      - 연결이 설정된 소켓에 데이터를 송신
      - 전송 데이터는 msg가 가리킴
      - sendto() : 비연결형 서비스에서 데이터를 송신

    -  recv (int s, void *buf, size_t len, int flags)

      - 연결이 설정된 소켓에서 데이터를 수신
      - 수신 데이터는 buf가 가리키는 공간에 저장됨
      - recvfrom() : 비연결형 서비스에서 데이터를 수신

      

- ### 연결형 서비스

  - 소켓: 네트워크 통신을 위한 소프트웨어 교신점

  - 두 개의 독립 프로세스가 네트워크를 통해 통신하려면 논리적인 연관관계를 맺어주는 소켓 필요

  - 서버의 동작

    - Well-known 포트에서 대기
    - 동작 과정

    1. 서비스 교신점 (호스트의 IP 주소, 포트 번호) 공개
    2. 클라이언트로부터 발생하는 서비스 요구 대기
    3. 클라이언트에 서비스 제공
    4. 해당 클라이언트에 서비스 제공 완료
    5. 단계 2로 이동

  - 클라이언트의 동작

    - 서버의 Well-known 포트로 접속을 시도
    - 동작 과정

    1. 원하는 서비스를 제공하는 서버 확인
    2. 해당 서버와 연결 시도
    3. 서버에 서비스 요청
    4. 서버에 서비스 요구 완료